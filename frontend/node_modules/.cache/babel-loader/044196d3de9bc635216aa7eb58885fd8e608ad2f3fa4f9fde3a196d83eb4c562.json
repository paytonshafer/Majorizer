{"ast":null,"code":"import _regeneratorRuntime from\"/Users/paytonshafer/Desktop/CS350/Majorizer/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/paytonshafer/Desktop/CS350/Majorizer/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/paytonshafer/Desktop/CS350/Majorizer/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";//This is the page where a student can send a request to their advisor\nimport React,{useContext,useState,useEffect}from'react';import AuthContext from'../context/AuthContext.js';//import StaticData from '../context/StaticData.js';\nimport'./styles/SendRequestPage.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var SendRequestPage=function SendRequestPage(){var _useContext=useContext(AuthContext),user=_useContext.user;var _useState=useState(),_useState2=_slicedToArray(_useState,2),adv=_useState2[0],setAdv=_useState2[1];//let {advisor_connections} = useContext(StaticData); //get advisor stud connecions for static data\n//Replace Advisor1in subheader with actual Advisor once data is stored\nuseEffect(function(){var getAdv=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('http://127.0.0.1:8000/api/studconn/'+user.id,{method:'GET',headers:{'Content-Type':'application/json'}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;//This should get the auth tokens if successful\nif(response.status===200){//if response is all good\nsetAdv(data);//set auth tokens\nlocalStorage.setItem('advconn',JSON.stringify(data));//put the auth tokens in local storage\n}else{alert('Something went wrong');}case 7:case\"end\":return _context.stop();}},_callee);}));return function getAdv(){return _ref.apply(this,arguments);};}();getAdv();},[user.id]);var send_req=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var postdata;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!(e.target.subject.value===''||e.target.data.value==='')){_context2.next=4;break;}alert('Please input both a subject and a message');_context2.next=7;break;case 4:postdata=JSON.stringify({'subject':e.target.subject.value,'data':e.target.data.value,'conn':adv.id});_context2.next=7;return fetch('http://127.0.0.1:8000/api/request/',{method:'POST',headers:{'Content-Type':'application/json'},body:postdata});case 7:case\"end\":return _context2.stop();}},_callee2);}));return function send_req(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"borderbox\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"username\",children:[\"What would you like to request, \",user.username,\"?\"]}),/*#__PURE__*/_jsxs(\"h2\",{className:\"subheader\",children:[\" Current Advisor: \",adv?adv.advisor.username:null]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(e){return window.confirm(\"Are you sure you want to send this message?\").then(send_req(e));},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"subject\",className:\"subjectbox\",placeholder:\"Subject\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"data\",className:\"responsebox\",placeholder:\"enter your message here...\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Submit\"})]})]})});};export default SendRequestPage;","map":{"version":3,"names":["React","useContext","useState","useEffect","AuthContext","jsxs","_jsxs","jsx","_jsx","SendRequestPage","_useContext","user","_useState","_useState2","_slicedToArray","adv","setAdv","getAdv","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","data","wrap","_callee$","_context","prev","next","fetch","id","method","headers","sent","json","status","localStorage","setItem","JSON","stringify","alert","stop","apply","arguments","send_req","_ref2","_callee2","e","postdata","_callee2$","_context2","target","subject","value","body","_x","children","className","username","advisor","onSubmit","window","confirm","then","type","name","placeholder"],"sources":["/Users/paytonshafer/Desktop/CS350/Majorizer/frontend/src/pages/SendRequestPage.jsx"],"sourcesContent":["//This is the page where a student can send a request to their advisor\nimport React, {useContext, useState, useEffect} from 'react'\nimport AuthContext from '../context/AuthContext.js'\n//import StaticData from '../context/StaticData.js';\nimport './styles/SendRequestPage.css'\nconst SendRequestPage = () => {\n    let {user} = useContext(AuthContext);\n    let [adv, setAdv] = useState();\n    //let {advisor_connections} = useContext(StaticData); //get advisor stud connecions for static data\n    //Replace Advisor1in subheader with actual Advisor once data is stored\n    useEffect(()=>{\n        let getAdv = async () => {\n            //Here we fetch from our api with the username and password to return our auth tokens\n            let response = await fetch('http://127.0.0.1:8000/api/studconn/' + user.id, {\n                method: 'GET',\n                headers:{\n                    'Content-Type': 'application/json'\n                }\n            })\n            let data = await response.json() //This should get the auth tokens if successful\n    \n            if(response.status === 200){ //if response is all good\n                setAdv(data) //set auth tokens\n                localStorage.setItem('advconn', JSON.stringify(data)) //put the auth tokens in local storage\n            }else{alert('Something went wrong')}\n        }\n        getAdv()\n    },[user.id])\n\n    const send_req = async (e) =>{\n        if(e.target.subject.value === '' || e.target.data.value === ''){\n            alert('Please input both a subject and a message')\n        }else{\n            let postdata = JSON.stringify({'subject': e.target.subject.value, 'data': e.target.data.value, 'conn': adv.id})\n            await fetch('http://127.0.0.1:8000/api/request/', {\n                method: 'POST',\n                headers:{\n                    'Content-Type': 'application/json'\n                },\n                body: postdata\n            })\n        }   \n    }\n\n    return (\n        <div>\n            <div className='borderbox'>\n            <h1 className='username'>What would you like to request, {user.username}?</h1>\n            <h2 className='subheader'> Current Advisor: {adv ? adv.advisor.username : null}</h2> \n            {/*on submit they will be asked if they are sure then we get an alert of the data that would be sent to the backend */}\n            <form onSubmit={(e) => window.confirm(\"Are you sure you want to send this message?\").then(send_req(e))}> \n                <input type='text' name='subject' className='subjectbox' placeholder='Subject'></input>\n                <textarea name='data' className='responsebox' placeholder=\"enter your message here...\"></textarea>\n                <input type='submit' value='Submit'></input>\n            </form>\n            </div>\n        </div>\n    )\n}\n\nexport default SendRequestPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}